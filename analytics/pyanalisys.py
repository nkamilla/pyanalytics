{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f008f88f",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sys\n",
    "import os\n",
    "\n",
    "os.environ['PYTHONIOENCODING'] = 'utf-8'\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "adf7996e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: psycopg2-binary in c:\\users\\79147\\anaconda3\\lib\\site-packages (2.9.9)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install psycopg2-binary"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "667e7cab",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Connected to the database successfully!\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "from sqlalchemy import create_engine\n",
    "\n",
    "engine = create_engine('postgresql://user:password@db:5432/movielens', connect_args={'client_encoding': 'latin_1'})\n",
    "print(\"Connected to the database successfully!\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "a5566773",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "movies.csv\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "movies = pd.read_csv('./movielens/ml-latest-small/movies.csv', encoding='latin_1') \n",
    "print('movies.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6ccdd26b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>Adventure|Children|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>Comedy|Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9737</th>\n",
       "      <td>193581</td>\n",
       "      <td>Black Butler: Book of the Atlantic (2017)</td>\n",
       "      <td>Action|Animation|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9738</th>\n",
       "      <td>193583</td>\n",
       "      <td>No Game No Life: Zero (2017)</td>\n",
       "      <td>Animation|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9739</th>\n",
       "      <td>193585</td>\n",
       "      <td>Flint (2017)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9740</th>\n",
       "      <td>193587</td>\n",
       "      <td>Bungo Stray Dogs: Dead Apple (2018)</td>\n",
       "      <td>Action|Animation</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9741</th>\n",
       "      <td>193609</td>\n",
       "      <td>Andrew Dice Clay: Dice Rules (1991)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>9742 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                      title  \\\n",
       "0           1                           Toy Story (1995)   \n",
       "1           2                             Jumanji (1995)   \n",
       "2           3                    Grumpier Old Men (1995)   \n",
       "3           4                   Waiting to Exhale (1995)   \n",
       "4           5         Father of the Bride Part II (1995)   \n",
       "...       ...                                        ...   \n",
       "9737   193581  Black Butler: Book of the Atlantic (2017)   \n",
       "9738   193583               No Game No Life: Zero (2017)   \n",
       "9739   193585                               Flint (2017)   \n",
       "9740   193587        Bungo Stray Dogs: Dead Apple (2018)   \n",
       "9741   193609        Andrew Dice Clay: Dice Rules (1991)   \n",
       "\n",
       "                                           genres  \n",
       "0     Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1                      Adventure|Children|Fantasy  \n",
       "2                                  Comedy|Romance  \n",
       "3                            Comedy|Drama|Romance  \n",
       "4                                          Comedy  \n",
       "...                                           ...  \n",
       "9737              Action|Animation|Comedy|Fantasy  \n",
       "9738                     Animation|Comedy|Fantasy  \n",
       "9739                                        Drama  \n",
       "9740                             Action|Animation  \n",
       "9741                                       Comedy  \n",
       "\n",
       "[9742 rows x 3 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(movies)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "e655435c",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       Adventure|Animation|Children|Comedy|Fantasy\n",
       "1                        Adventure|Children|Fantasy\n",
       "2                                    Comedy|Romance\n",
       "3                              Comedy|Drama|Romance\n",
       "4                                            Comedy\n",
       "                           ...                     \n",
       "9737                Action|Animation|Comedy|Fantasy\n",
       "9738                       Animation|Comedy|Fantasy\n",
       "9739                                          Drama\n",
       "9740                               Action|Animation\n",
       "9741                                         Comedy\n",
       "Name: genres, Length: 9742, dtype: object"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "movies_genres = movies.loc[:, 'genres']\n",
    "display(movies_genres)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "fa0980bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Adventure|Animation|Children|Comedy|Fantasy'"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies_genres[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9377c672",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9737"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies.title.nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "8619b537",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Key max: Drama\n",
      "Value max: 4361\n"
     ]
    }
   ],
   "source": [
    "genres_dict = {}\n",
    "\n",
    "\n",
    "for genres in movies_genres:\n",
    "    #print(genres.split('|'))\n",
    "    for genre in genres.split('|'):\n",
    "        if genre in genres_dict:\n",
    "            genres_dict[genre] = genres_dict[genre] + 1\n",
    "        else:\n",
    "            genres_dict[genre] = 1\n",
    "\n",
    "#for k, v in genres_dict.items():\n",
    "    #print(k ,v)\n",
    "key_max = max(genres_dict, key = genres_dict.get)\n",
    "print(f'Key max: {key_max}')\n",
    "print(f'Value max: {genres_dict[key_max]}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67c9e837",
   "metadata": {},
   "outputs": [],
   "source": [
    "#plik ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "9b8cffa4",
   "metadata": {},
   "outputs": [],
   "source": [
    "ratings = pd.read_csv('./movielens/ml-latest-small/ratings.csv', encoding='latin_1') \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "6ce40c2f",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4.0</td>\n",
       "      <td>964982703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4.0</td>\n",
       "      <td>964981247</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>4.0</td>\n",
       "      <td>964982224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>5.0</td>\n",
       "      <td>964983815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>964982931</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100831</th>\n",
       "      <td>610</td>\n",
       "      <td>166534</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1493848402</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100832</th>\n",
       "      <td>610</td>\n",
       "      <td>168248</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1493850091</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100833</th>\n",
       "      <td>610</td>\n",
       "      <td>168250</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1494273047</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100834</th>\n",
       "      <td>610</td>\n",
       "      <td>168252</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1493846352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100835</th>\n",
       "      <td>610</td>\n",
       "      <td>170875</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1493846415</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100836 rows Ã— 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        userId  movieId  rating   timestamp\n",
       "0            1        1     4.0   964982703\n",
       "1            1        3     4.0   964981247\n",
       "2            1        6     4.0   964982224\n",
       "3            1       47     5.0   964983815\n",
       "4            1       50     5.0   964982931\n",
       "...        ...      ...     ...         ...\n",
       "100831     610   166534     4.0  1493848402\n",
       "100832     610   168248     5.0  1493850091\n",
       "100833     610   168250     5.0  1494273047\n",
       "100834     610   168252     5.0  1493846352\n",
       "100835     610   170875     3.0  1493846415\n",
       "\n",
       "[100836 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(ratings)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "28d53417",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.movieId[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "5a1a20ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{97024: 0.5,\n",
       " 86068: 0.5,\n",
       " 107013: 0.5,\n",
       " 138186: 0.5,\n",
       " 160872: 0.5,\n",
       " 173307: 0.5,\n",
       " 5672: 0.5,\n",
       " 6371: 0.5,\n",
       " 60363: 0.5,\n",
       " 7312: 0.5,\n",
       " 3604: 0.5,\n",
       " 77427: 0.5,\n",
       " 104644: 0.5,\n",
       " 110773: 0.5,\n",
       " 165645: 0.5,\n",
       " 175475: 0.5,\n",
       " 184641: 0.5,\n",
       " 83601: 0.5,\n",
       " 54768: 0.5,\n",
       " 31692: 0.5,\n",
       " 57326: 0.5,\n",
       " 54934: 0.5,\n",
       " 67799: 0.5,\n",
       " 134528: 0.5,\n",
       " 138798: 0.5,\n",
       " 4371: 0.5,\n",
       " 4750: 0.5,\n",
       " 7636: 0.5,\n",
       " 31422: 0.5,\n",
       " 31424: 0.5,\n",
       " 26095: 0.5,\n",
       " 65350: 0.5,\n",
       " 85334: 0.5,\n",
       " 89386: 0.5,\n",
       " 4580: 0.5,\n",
       " 72696: 0.5,\n",
       " 95796: 0.5,\n",
       " 3933: 0.5,\n",
       " 4051: 0.5,\n",
       " 4775: 0.5,\n",
       " 5356: 0.5,\n",
       " 5700: 0.5,\n",
       " 6514: 0.5,\n",
       " 8136: 0.5,\n",
       " 8137: 0.5,\n",
       " 53453: 0.5,\n",
       " 82095: 0.5,\n",
       " 102025: 0.5,\n",
       " 125221: 0.5,\n",
       " 129250: 0.5,\n",
       " 137517: 0.5,\n",
       " 151745: 0.5,\n",
       " 157172: 0.5,\n",
       " 5771: 0.5,\n",
       " 8632: 0.5,\n",
       " 135216: 0.5,\n",
       " 141994: 0.5,\n",
       " 8772: 0.5,\n",
       " 91414: 0.5,\n",
       " 144352: 0.5,\n",
       " 167296: 0.5,\n",
       " 25782: 0.5,\n",
       " 26717: 0.5,\n",
       " 82684: 0.5,\n",
       " 92681: 0.5,\n",
       " 109897: 0.5,\n",
       " 110603: 0.5,\n",
       " 122246: 0.5,\n",
       " 122888: 0.5,\n",
       " 134246: 0.5,\n",
       " 141668: 0.5,\n",
       " 151687: 0.5,\n",
       " 152063: 0.5,\n",
       " 8236: 0.5,\n",
       " 8494: 0.5,\n",
       " 5105: 0.5,\n",
       " 6967: 0.5,\n",
       " 7114: 0.5,\n",
       " 7742: 0.5,\n",
       " 6557: 0.5,\n",
       " 26696: 0.5,\n",
       " 27595: 0.5,\n",
       " 44243: 0.5,\n",
       " 54274: 0.5,\n",
       " 71810: 0.5,\n",
       " 76030: 0.5,\n",
       " 102735: 0.5,\n",
       " 102749: 0.5,\n",
       " 104017: 0.5,\n",
       " 111785: 0.5,\n",
       " 122627: 0.5,\n",
       " 136297: 0.5,\n",
       " 145724: 0.5,\n",
       " 61818: 0.5,\n",
       " 72424: 0.5,\n",
       " 145951: 0.5,\n",
       " 59306: 0.75,\n",
       " 3774: 0.75,\n",
       " 55292: 0.75,\n",
       " 4412: 0.75,\n",
       " 1328: 0.75,\n",
       " 8290: 0.75,\n",
       " 4125: 0.75,\n",
       " 8387: 0.8,\n",
       " 6483: 0.8333333333333334,\n",
       " 61348: 0.8333333333333334,\n",
       " 43919: 0.8333333333333334,\n",
       " 6827: 0.8333333333333334,\n",
       " 5962: 1.0,\n",
       " 1427: 1.0,\n",
       " 2614: 1.0,\n",
       " 2754: 1.0,\n",
       " 125916: 1.0,\n",
       " 2164: 1.0,\n",
       " 92427: 1.0,\n",
       " 103171: 1.0,\n",
       " 136305: 1.0,\n",
       " 142602: 1.0,\n",
       " 156607: 1.0,\n",
       " 160569: 1.0,\n",
       " 50806: 1.0,\n",
       " 74647: 1.0,\n",
       " 1519: 1.0,\n",
       " 2651: 1.0,\n",
       " 64114: 1.0,\n",
       " 91671: 1.0,\n",
       " 69685: 1.0,\n",
       " 71205: 1.0,\n",
       " 78174: 1.0,\n",
       " 171631: 1.0,\n",
       " 2775: 1.0,\n",
       " 1163: 1.0,\n",
       " 2818: 1.0,\n",
       " 165635: 1.0,\n",
       " 178: 1.0,\n",
       " 4932: 1.0,\n",
       " 698: 1.0,\n",
       " 123553: 1.0,\n",
       " 189547: 1.0,\n",
       " 870: 1.0,\n",
       " 3433: 1.0,\n",
       " 3434: 1.0,\n",
       " 32666: 1.0,\n",
       " 3106: 1.0,\n",
       " 47810: 1.0,\n",
       " 476: 1.0,\n",
       " 74075: 1.0,\n",
       " 1574: 1.0,\n",
       " 2964: 1.0,\n",
       " 5884: 1.0,\n",
       " 4522: 1.0,\n",
       " 8383: 1.0,\n",
       " 96121: 1.0,\n",
       " 127323: 1.0,\n",
       " 470: 1.0,\n",
       " 3043: 1.0,\n",
       " 3667: 1.0,\n",
       " 1526: 1.0,\n",
       " 2516: 1.0,\n",
       " 7282: 1.0,\n",
       " 58287: 1.0,\n",
       " 3899: 1.0,\n",
       " 190213: 1.0,\n",
       " 190219: 1.0,\n",
       " 190221: 1.0,\n",
       " 2226: 1.0,\n",
       " 176579: 1.0,\n",
       " 109569: 1.0,\n",
       " 3716: 1.0,\n",
       " 3922: 1.0,\n",
       " 31698: 1.0,\n",
       " 103449: 1.0,\n",
       " 55259: 1.0,\n",
       " 46865: 1.0,\n",
       " 131934: 1.0,\n",
       " 170289: 1.0,\n",
       " 2835: 1.0,\n",
       " 4138: 1.0,\n",
       " 4675: 1.0,\n",
       " 5278: 1.0,\n",
       " 6574: 1.0,\n",
       " 59295: 1.0,\n",
       " 2665: 1.0,\n",
       " 6347: 1.0,\n",
       " 5675: 1.0,\n",
       " 2887: 1.0,\n",
       " 3276: 1.0,\n",
       " 3596: 1.0,\n",
       " 4630: 1.0,\n",
       " 6302: 1.0,\n",
       " 6424: 1.0,\n",
       " 7245: 1.0,\n",
       " 8447: 1.0,\n",
       " 63393: 1.0,\n",
       " 85399: 1.0,\n",
       " 102880: 1.0,\n",
       " 104760: 1.0,\n",
       " 105121: 1.0,\n",
       " 128592: 1.0,\n",
       " 129657: 1.0,\n",
       " 132462: 1.0,\n",
       " 133545: 1.0,\n",
       " 136664: 1.0,\n",
       " 157432: 1.0,\n",
       " 161290: 1.0,\n",
       " 161830: 1.0,\n",
       " 4129: 1.0,\n",
       " 4204: 1.0,\n",
       " 4635: 1.0,\n",
       " 5863: 1.0,\n",
       " 6853: 1.0,\n",
       " 105325: 1.0,\n",
       " 72874: 1.0,\n",
       " 50954: 1.0,\n",
       " 449: 1.0,\n",
       " 1824: 1.0,\n",
       " 1335: 1.0,\n",
       " 167538: 1.0,\n",
       " 97194: 1.0,\n",
       " 162590: 1.0,\n",
       " 2742: 1.0,\n",
       " 5560: 1.0,\n",
       " 2573: 1.0,\n",
       " 168712: 1.0,\n",
       " 1336: 1.0,\n",
       " 2862: 1.0,\n",
       " 3442: 1.0,\n",
       " 3574: 1.0,\n",
       " 71438: 1.0,\n",
       " 114554: 1.0,\n",
       " 132335: 1.0,\n",
       " 166526: 1.0,\n",
       " 179491: 1.0,\n",
       " 2740: 1.0,\n",
       " 2538: 1.0,\n",
       " 2623: 1.0,\n",
       " 1426: 1.0,\n",
       " 5591: 1.0,\n",
       " 7986: 1.0,\n",
       " 8934: 1.0,\n",
       " 27008: 1.0,\n",
       " 31553: 1.0,\n",
       " 43419: 1.0,\n",
       " 55061: 1.0,\n",
       " 69227: 1.0,\n",
       " 71550: 1.0,\n",
       " 112326: 1.0,\n",
       " 117630: 1.0,\n",
       " 122433: 1.0,\n",
       " 140852: 1.0,\n",
       " 160978: 1.0,\n",
       " 169958: 1.0,\n",
       " 2417: 1.0,\n",
       " 2813: 1.0,\n",
       " 2892: 1.0,\n",
       " 4786: 1.0,\n",
       " 35347: 1.0,\n",
       " 8840: 1.0,\n",
       " 1326: 1.125,\n",
       " 50798: 1.125,\n",
       " 6872: 1.125,\n",
       " 5428: 1.125,\n",
       " 3973: 1.125,\n",
       " 1324: 1.1666666666666667,\n",
       " 50189: 1.1666666666666667,\n",
       " 83177: 1.1666666666666667,\n",
       " 5323: 1.1875,\n",
       " 139717: 1.25,\n",
       " 4124: 1.25,\n",
       " 8677: 1.25,\n",
       " 3768: 1.25,\n",
       " 44399: 1.25,\n",
       " 3141: 1.25,\n",
       " 4749: 1.25,\n",
       " 97470: 1.25,\n",
       " 6554: 1.25,\n",
       " 1325: 1.25,\n",
       " 2332: 1.25,\n",
       " 77798: 1.25,\n",
       " 26764: 1.25,\n",
       " 93980: 1.25,\n",
       " 5096: 1.25,\n",
       " 43904: 1.3,\n",
       " 2799: 1.3125,\n",
       " 8666: 1.3333333333333333,\n",
       " 3324: 1.3333333333333333,\n",
       " 3393: 1.3333333333333333,\n",
       " 44731: 1.3333333333333333,\n",
       " 49276: 1.3333333333333333,\n",
       " 4845: 1.3333333333333333,\n",
       " 2119: 1.3333333333333333,\n",
       " 1760: 1.35,\n",
       " 5248: 1.375,\n",
       " 4104: 1.4,\n",
       " 1389: 1.4166666666666667,\n",
       " 312: 1.4444444444444444,\n",
       " 179: 1.5,\n",
       " 1322: 1.5,\n",
       " 1330: 1.5,\n",
       " 2244: 1.5,\n",
       " 2255: 1.5,\n",
       " 2465: 1.5,\n",
       " 8574: 1.5,\n",
       " 52730: 1.5,\n",
       " 73858: 1.5,\n",
       " 107449: 1.5,\n",
       " 149380: 1.5,\n",
       " 2886: 1.5,\n",
       " 27793: 1.5,\n",
       " 142074: 1.5,\n",
       " 7411: 1.5,\n",
       " 27705: 1.5,\n",
       " 111320: 1.5,\n",
       " 2383: 1.5,\n",
       " 167772: 1.5,\n",
       " 6203: 1.5,\n",
       " 74275: 1.5,\n",
       " 136443: 1.5,\n",
       " 175577: 1.5,\n",
       " 181139: 1.5,\n",
       " 164881: 1.5,\n",
       " 5879: 1.5,\n",
       " 101973: 1.5,\n",
       " 2364: 1.5,\n",
       " 56176: 1.5,\n",
       " 3895: 1.5,\n",
       " 3573: 1.5,\n",
       " 180987: 1.5,\n",
       " 183911: 1.5,\n",
       " 1055: 1.5,\n",
       " 564: 1.5,\n",
       " 3432: 1.5,\n",
       " 6425: 1.5,\n",
       " 91483: 1.5,\n",
       " 8626: 1.5,\n",
       " 27434: 1.5,\n",
       " 30883: 1.5,\n",
       " 183011: 1.5,\n",
       " 1998: 1.5,\n",
       " 7016: 1.5,\n",
       " 26686: 1.5,\n",
       " 3908: 1.5,\n",
       " 5556: 1.5,\n",
       " 6794: 1.5,\n",
       " 33132: 1.5,\n",
       " 45361: 1.5,\n",
       " 3313: 1.5,\n",
       " 3833: 1.5,\n",
       " 2828: 1.5,\n",
       " 278: 1.5,\n",
       " 1440: 1.5,\n",
       " 1490: 1.5,\n",
       " 3280: 1.5,\n",
       " 3830: 1.5,\n",
       " 5443: 1.5,\n",
       " 5538: 1.5,\n",
       " 5539: 1.5,\n",
       " 5664: 1.5,\n",
       " 5736: 1.5,\n",
       " 5883: 1.5,\n",
       " 6153: 1.5,\n",
       " 7781: 1.5,\n",
       " 26792: 1.5,\n",
       " 4483: 1.5,\n",
       " 3884: 1.5,\n",
       " 4471: 1.5,\n",
       " 190207: 1.5,\n",
       " 190215: 1.5,\n",
       " 96964: 1.5,\n",
       " 101415: 1.5,\n",
       " 114494: 1.5,\n",
       " 145935: 1.5,\n",
       " 152: 1.5,\n",
       " 52279: 1.5,\n",
       " 93139: 1.5,\n",
       " 158254: 1.5,\n",
       " 4985: 1.5,\n",
       " 2552: 1.5,\n",
       " 4462: 1.5,\n",
       " 6631: 1.5,\n",
       " 7390: 1.5,\n",
       " 4093: 1.5,\n",
       " 4756: 1.5,\n",
       " 5334: 1.5,\n",
       " 69118: 1.5,\n",
       " 69453: 1.5,\n",
       " 73386: 1.5,\n",
       " 75803: 1.5,\n",
       " 82093: 1.5,\n",
       " 89388: 1.5,\n",
       " 89427: 1.5,\n",
       " 90738: 1.5,\n",
       " 91273: 1.5,\n",
       " 91688: 1.5,\n",
       " 91873: 1.5,\n",
       " 93242: 1.5,\n",
       " 94011: 1.5,\n",
       " 96726: 1.5,\n",
       " 97742: 1.5,\n",
       " 98160: 1.5,\n",
       " 98175: 1.5,\n",
       " 98296: 1.5,\n",
       " 98908: 1.5,\n",
       " 99005: 1.5,\n",
       " 100226: 1.5,\n",
       " 101360: 1.5,\n",
       " 101884: 1.5,\n",
       " 103502: 1.5,\n",
       " 105755: 1.5,\n",
       " 106542: 1.5,\n",
       " 106883: 1.5,\n",
       " 108715: 1.5,\n",
       " 109191: 1.5,\n",
       " 110826: 1.5,\n",
       " 111680: 1.5,\n",
       " 112303: 1.5,\n",
       " 113350: 1.5,\n",
       " 113416: 1.5,\n",
       " 116207: 1.5,\n",
       " 116419: 1.5,\n",
       " 116985: 1.5,\n",
       " 118248: 1.5,\n",
       " 118512: 1.5,\n",
       " 122490: 1.5,\n",
       " 126420: 1.5,\n",
       " 127319: 1.5,\n",
       " 129333: 1.5,\n",
       " 132618: 1.5,\n",
       " 133195: 1.5,\n",
       " 133377: 1.5,\n",
       " 133798: 1.5,\n",
       " 134158: 1.5,\n",
       " 136654: 1.5,\n",
       " 136786: 1.5,\n",
       " 136800: 1.5,\n",
       " 136859: 1.5,\n",
       " 138546: 1.5,\n",
       " 139857: 1.5,\n",
       " 140525: 1.5,\n",
       " 143001: 1.5,\n",
       " 143255: 1.5,\n",
       " 143472: 1.5,\n",
       " 144714: 1.5,\n",
       " 151501: 1.5,\n",
       " 151653: 1.5,\n",
       " 152658: 1.5,\n",
       " 157407: 1.5,\n",
       " 158022: 1.5,\n",
       " 160440: 1.5,\n",
       " 161918: 1.5,\n",
       " 164375: 1.5,\n",
       " 165343: 1.5,\n",
       " 8620: 1.5,\n",
       " 5213: 1.5,\n",
       " 5455: 1.5,\n",
       " 26791: 1.5,\n",
       " 6320: 1.5,\n",
       " 36397: 1.5,\n",
       " 3294: 1.5,\n",
       " 5041: 1.5,\n",
       " 5189: 1.5,\n",
       " 8894: 1.5,\n",
       " 4646: 1.5,\n",
       " 93740: 1.5,\n",
       " 1986: 1.5,\n",
       " 70015: 1.5,\n",
       " 92234: 1.5,\n",
       " 104337: 1.5,\n",
       " 114396: 1.5,\n",
       " 152071: 1.5,\n",
       " 179749: 1.5,\n",
       " 179815: 1.5,\n",
       " 8427: 1.5,\n",
       " 806: 1.5,\n",
       " 2339: 1.5,\n",
       " 3962: 1.5,\n",
       " 4394: 1.5,\n",
       " 4504: 1.5,\n",
       " 5053: 1.5,\n",
       " 5111: 1.5,\n",
       " 5596: 1.5,\n",
       " 5961: 1.5,\n",
       " 6587: 1.5,\n",
       " 7005: 1.5,\n",
       " 8043: 1.5,\n",
       " 26741: 1.5,\n",
       " 26828: 1.5,\n",
       " 26913: 1.5,\n",
       " 27074: 1.5,\n",
       " 27306: 1.5,\n",
       " 27549: 1.5,\n",
       " 27784: 1.5,\n",
       " 33966: 1.5,\n",
       " 34292: 1.5,\n",
       " 34800: 1.5,\n",
       " 53450: 1.5,\n",
       " 60365: 1.5,\n",
       " 75416: 1.5,\n",
       " 103609: 1.5,\n",
       " 105020: 1.5,\n",
       " 116044: 1.5,\n",
       " 116963: 1.5,\n",
       " 136012: 1.5,\n",
       " 151479: 1.5,\n",
       " 157865: 1.5,\n",
       " 169670: 1.5,\n",
       " 68480: 1.5,\n",
       " 5275: 1.5,\n",
       " 61262: 1.5,\n",
       " 99721: 1.5,\n",
       " 138610: 1.5,\n",
       " 3238: 1.5833333333333333,\n",
       " 3799: 1.5833333333333333,\n",
       " 2798: 1.5833333333333333,\n",
       " 45732: 1.5833333333333333,\n",
       " 3955: 1.5833333333333333,\n",
       " 5452: 1.5833333333333333,\n",
       " 92938: 1.6,\n",
       " 1556: 1.605263157894737,\n",
       " 4686: 1.625,\n",
       " 4502: 1.625,\n",
       " 3564: 1.625,\n",
       " 4305: 1.625,\n",
       " 3593: 1.6578947368421053,\n",
       " 5841: 1.6666666666666667,\n",
       " 2555: 1.6666666666666667,\n",
       " 3839: 1.6666666666666667,\n",
       " 175485: 1.6666666666666667,\n",
       " 2816: 1.6666666666666667,\n",
       " 3431: 1.6666666666666667,\n",
       " 4852: 1.6666666666666667,\n",
       " 1995: 1.6666666666666667,\n",
       " 3767: 1.6666666666666667,\n",
       " 3710: 1.6666666666666667,\n",
       " 1323: 1.6666666666666667,\n",
       " 4127: 1.6666666666666667,\n",
       " 4673: 1.6666666666666667,\n",
       " 4862: 1.6666666666666667,\n",
       " 6348: 1.6666666666666667,\n",
       " 2643: 1.6875,\n",
       " 71: 1.7,\n",
       " 867: 1.75,\n",
       " 2422: 1.75,\n",
       " 109864: 1.75,\n",
       " 4629: 1.75,\n",
       " 1642: 1.75,\n",
       " 132424: 1.75,\n",
       " 1624: 1.75,\n",
       " 5346: 1.75,\n",
       " 89190: 1.75,\n",
       " 27685: 1.75,\n",
       " 1602: 1.75,\n",
       " 1731: 1.75,\n",
       " 2786: 1.75,\n",
       " 2515: 1.75,\n",
       " 6013: 1.75,\n",
       " 8830: 1.75,\n",
       " 8912: 1.75,\n",
       " 43932: 1.75,\n",
       " 4248: 1.75,\n",
       " 8967: 1.75,\n",
       " 3689: 1.75,\n",
       " 2149: 1.75,\n",
       " 2154: 1.75,\n",
       " 5361: 1.75,\n",
       " 5735: 1.75,\n",
       " 33681: 1.75,\n",
       " 4517: 1.75,\n",
       " 104074: 1.75,\n",
       " 5880: 1.75,\n",
       " 8943: 1.75,\n",
       " 87413: 1.75,\n",
       " 2586: 1.75,\n",
       " 5597: 1.75,\n",
       " 3268: 1.7727272727272727,\n",
       " 6793: 1.7727272727272727,\n",
       " 7701: 1.7857142857142858,\n",
       " 5094: 1.7857142857142858,\n",
       " 1993: 1.8,\n",
       " 4030: 1.8,\n",
       " 6166: 1.8125,\n",
       " 4131: 1.8333333333333333,\n",
       " 2027: 1.8333333333333333,\n",
       " 2548: 1.8333333333333333,\n",
       " 3997: 1.8333333333333333,\n",
       " 424: 1.8333333333333333,\n",
       " 1453: 1.8333333333333333,\n",
       " 82854: 1.8333333333333333,\n",
       " 82852: 1.8333333333333333,\n",
       " 4130: 1.8333333333333333,\n",
       " 2748: 1.8333333333333333,\n",
       " 2526: 1.8333333333333333,\n",
       " 4723: 1.8333333333333333,\n",
       " 117895: 1.8333333333333333,\n",
       " 2514: 1.8333333333333333,\n",
       " 33164: 1.8333333333333333,\n",
       " 103655: 1.8333333333333333,\n",
       " 5401: 1.8333333333333333,\n",
       " 4563: 1.8333333333333333,\n",
       " 4081: 1.8333333333333333,\n",
       " 5471: 1.8333333333333333,\n",
       " 6315: 1.8333333333333333,\n",
       " 6880: 1.8571428571428572,\n",
       " 473: 1.8571428571428572,\n",
       " 6996: 1.8571428571428572,\n",
       " 5501: 1.8571428571428572,\n",
       " 98203: 1.875,\n",
       " 1382: 1.875,\n",
       " 78467: 1.875,\n",
       " 42009: 1.875,\n",
       " 6695: 1.875,\n",
       " 1707: 1.875,\n",
       " 112370: 1.875,\n",
       " 132796: 1.875,\n",
       " 1996: 1.875,\n",
       " 88356: 1.875,\n",
       " 104076: 1.875,\n",
       " 103596: 1.875,\n",
       " 2389: 1.8888888888888888,\n",
       " 4732: 1.8888888888888888,\n",
       " 3248: 1.8928571428571428,\n",
       " 6624: 1.9,\n",
       " 2404: 1.9166666666666667,\n",
       " 4676: 1.9166666666666667,\n",
       " 6212: 1.9166666666666667,\n",
       " 78893: 1.9166666666666667,\n",
       " 43928: 1.9230769230769231,\n",
       " 1499: 1.9259259259259258,\n",
       " 1681: 1.9285714285714286,\n",
       " 4477: 1.9375,\n",
       " 7161: 1.9375,\n",
       " 2392: 1.9375,\n",
       " 2412: 1.9411764705882353,\n",
       " 1862: 1.9444444444444444,\n",
       " 1882: 1.9545454545454546,\n",
       " 6482: 1.9545454545454546,\n",
       " 126: 2.0,\n",
       " 4260: 2.0,\n",
       " 546: 2.0,\n",
       " 6044: 2.0,\n",
       " 77841: 2.0,\n",
       " 1355: 2.0,\n",
       " 1456: 2.0,\n",
       " 1679: 2.0,\n",
       " 1798: 2.0,\n",
       " 1816: 2.0,\n",
       " 1881: 2.0,\n",
       " 1891: 2.0,\n",
       " 2026: 2.0,\n",
       " 2446: 2.0,\n",
       " 2733: 2.0,\n",
       " 2898: 2.0,\n",
       " 3048: 2.0,\n",
       " 3190: 2.0,\n",
       " 3225: 2.0,\n",
       " 3584: 2.0,\n",
       " 3743: 2.0,\n",
       " 3802: 2.0,\n",
       " 4449: 2.0,\n",
       " 109576: 2.0,\n",
       " 119964: 2.0,\n",
       " 142536: 2.0,\n",
       " 148675: 2.0,\n",
       " 2032: 2.0,\n",
       " 2876: 2.0,\n",
       " 4251: 2.0,\n",
       " 45658: 2.0,\n",
       " 59129: 2.0,\n",
       " 61011: 2.0,\n",
       " 61628: 2.0,\n",
       " 2500: 2.0,\n",
       " 2574: 2.0,\n",
       " 3694: 2.0,\n",
       " 3695: 2.0,\n",
       " 4207: 2.0,\n",
       " 833: 2.0,\n",
       " 46062: 2.0,\n",
       " 63312: 2.0,\n",
       " 1999: 2.0,\n",
       " 3773: 2.0,\n",
       " 128512: 2.0,\n",
       " 42018: 2.0,\n",
       " 53435: 2.0,\n",
       " 112450: 2.0,\n",
       " 2659: 2.0,\n",
       " 6566: 2.0,\n",
       " 6687: 2.0,\n",
       " 6464: 2.0,\n",
       " 6271: 2.0,\n",
       " 8814: 2.0,\n",
       " 172321: 2.0,\n",
       " 176621: 2.0,\n",
       " 1981: 2.0,\n",
       " 2790: 2.0,\n",
       " 2817: 2.0,\n",
       " 2868: 2.0,\n",
       " 4316: 2.0,\n",
       " 4909: 2.0,\n",
       " 4987: 2.0,\n",
       " 7650: 2.0,\n",
       " 3690: 2.0,\n",
       " 6030: 2.0,\n",
       " 5564: 2.0,\n",
       " 92264: 2.0,\n",
       " 112497: 2.0,\n",
       " 136511: 2.0,\n",
       " 158813: 2.0,\n",
       " 170897: 2.0,\n",
       " 73488: 2.0,\n",
       " 149902: 2.0,\n",
       " 567: 2.0,\n",
       " 1318: 2.0,\n",
       " 6251: 2.0,\n",
       " 4613: 2.0,\n",
       " 3597: 2.0,\n",
       " 5338: 2.0,\n",
       " 8121: 2.0,\n",
       " 1107: 2.0,\n",
       " 3572: 2.0,\n",
       " 3909: 2.0,\n",
       " 7065: 2.0,\n",
       " 34336: 2.0,\n",
       " 3879: 2.0,\n",
       " 5612: 2.0,\n",
       " 103210: 2.0,\n",
       " 178111: 2.0,\n",
       " 5610: 2.0,\n",
       " 4625: 2.0,\n",
       " 65651: 2.0,\n",
       " 184053: 2.0,\n",
       " 275: 2.0,\n",
       " 429: 2.0,\n",
       " 692: 2.0,\n",
       " 1677: 2.0,\n",
       " 1867: 2.0,\n",
       " 2152: 2.0,\n",
       " 2525: 2.0,\n",
       " 2537: 2.0,\n",
       " 2741: 2.0,\n",
       " 3014: 2.0,\n",
       " 3132: 2.0,\n",
       " 3389: 2.0,\n",
       " 61246: 2.0,\n",
       " 30818: 2.0,\n",
       " 59014: 2.0,\n",
       " 91628: 2.0,\n",
       " 101531: 2.0,\n",
       " 103137: 2.0,\n",
       " 1887: 2.0,\n",
       " 4233: 2.0,\n",
       " 5456: 2.0,\n",
       " 52715: 2.0,\n",
       " 6057: 2.0,\n",
       " 6959: 2.0,\n",
       " 7257: 2.0,\n",
       " 7262: 2.0,\n",
       " 31223: 2.0,\n",
       " 31431: 2.0,\n",
       " 32589: 2.0,\n",
       " 33158: 2.0,\n",
       " 40946: 2.0,\n",
       " 45208: 2.0,\n",
       " 51082: 2.0,\n",
       " 136912: 2.0,\n",
       " 1495: 2.0,\n",
       " 1826: 2.0,\n",
       " 2566: 2.0,\n",
       " 86960: 2.0,\n",
       " 26629: 2.0,\n",
       " 50147: 2.0,\n",
       " 50440: 2.0,\n",
       " 57910: 2.0,\n",
       " 298: 2.0,\n",
       " 5258: 2.0,\n",
       " 2120: 2.0,\n",
       " 2286: 2.0,\n",
       " 2460: 2.0,\n",
       " 3331: 2.0,\n",
       " 5638: 2.0,\n",
       " 129: 2.0,\n",
       " 92192: 2.0,\n",
       " 113345: 2.0,\n",
       " 1746: 2.0,\n",
       " 34523: 2.0,\n",
       " 61729: 2.0,\n",
       " 68600: 2.0,\n",
       " 71248: 2.0,\n",
       " 109895: 2.0,\n",
       " 112911: 2.0,\n",
       " 116138: 2.0,\n",
       " 134783: 2.0,\n",
       " 134808: 2.0,\n",
       " 140016: 2.0,\n",
       " 409: 2.0,\n",
       " 2190: 2.0,\n",
       " 4181: 2.0,\n",
       " 4584: 2.0,\n",
       " 4885: 2.0,\n",
       " 6316: 2.0,\n",
       " 7708: 2.0,\n",
       " 8402: 2.0,\n",
       " 9005: 2.0,\n",
       " 33171: 2.0,\n",
       " 34143: 2.0,\n",
       " 65601: 2.0,\n",
       " 5925: 2.0,\n",
       " 703: 2.0,\n",
       " 2882: 2.0,\n",
       " 4714: 2.0,\n",
       " 2188: 2.0,\n",
       " 87028: 2.0,\n",
       " 176389: 2.0,\n",
       " 113604: 2.0,\n",
       " 2695: 2.0,\n",
       " 882: 2.0,\n",
       " 5706: 2.0,\n",
       " 5476: 2.0,\n",
       " 27683: 2.0,\n",
       " 96007: 2.0,\n",
       " 176935: 2.0,\n",
       " 53326: 2.0,\n",
       " 50003: 2.0,\n",
       " 152079: 2.0,\n",
       " 4355: 2.0,\n",
       " 3838: 2.0,\n",
       " 4988: 2.0,\n",
       " 7951: 2.0,\n",
       " 26124: 2.0,\n",
       " 5575: 2.0,\n",
       " 3590: 2.0,\n",
       " 2884: 2.0,\n",
       " 3625: 2.0,\n",
       " 3847: 2.0,\n",
       " 4089: 2.0,\n",
       " 4115: 2.0,\n",
       " 4123: 2.0,\n",
       " 4242: 2.0,\n",
       " 4290: 2.0,\n",
       " 4463: 2.0,\n",
       " 4573: 2.0,\n",
       " 4610: 2.0,\n",
       " 4780: 2.0,\n",
       " 4818: 2.0,\n",
       " 4926: 2.0,\n",
       " 4962: 2.0,\n",
       " 5209: 2.0,\n",
       " 5321: 2.0,\n",
       " 6295: 2.0,\n",
       " 6314: 2.0,\n",
       " 6349: 2.0,\n",
       " 6493: 2.0,\n",
       " 6560: 2.0,\n",
       " 6628: 2.0,\n",
       " 7315: 2.0,\n",
       " 43912: 2.0,\n",
       " 48319: 2.0,\n",
       " 2368: 2.0,\n",
       " 3390: 2.0,\n",
       " 4156: 2.0,\n",
       " 4952: 2.0,\n",
       " 5779: 2.0,\n",
       " 43558: 2.0,\n",
       " 53808: 2.0,\n",
       " 61123: 2.0,\n",
       " 67361: 2.0,\n",
       " 70545: 2.0,\n",
       " 72694: 2.0,\n",
       " 75816: 2.0,\n",
       " 85025: 2.0,\n",
       " 86028: 2.0,\n",
       " 92198: 2.0,\n",
       " 93982: 2.0,\n",
       " 96114: 2.0,\n",
       " 97858: 2.0,\n",
       " 98836: 2.0,\n",
       " 99415: 2.0,\n",
       " 100487: 2.0,\n",
       " 101529: 2.0,\n",
       " 102165: 2.0,\n",
       " 102278: 2.0,\n",
       " 103865: 2.0,\n",
       " 106330: 2.0,\n",
       " 107945: 2.0,\n",
       " 107962: 2.0,\n",
       " 108188: 2.0,\n",
       " 108601: 2.0,\n",
       " 109183: 2.0,\n",
       " 109295: 2.0,\n",
       " 109416: 2.0,\n",
       " 110655: 2.0,\n",
       " 112749: 2.0,\n",
       " 114925: 2.0,\n",
       " 115151: 2.0,\n",
       " 118326: 2.0,\n",
       " 118814: 2.0,\n",
       " 119068: 2.0,\n",
       " 122932: 2.0,\n",
       " 124859: 2.0,\n",
       " 127132: 2.0,\n",
       " 127194: 2.0,\n",
       " 130083: 2.0,\n",
       " 131480: 2.0,\n",
       " 132488: 2.0,\n",
       " 133281: 2.0,\n",
       " 133365: 2.0,\n",
       " 133782: 2.0,\n",
       " 136778: 2.0,\n",
       " 139052: 2.0,\n",
       " 140237: 2.0,\n",
       " 140850: 2.0,\n",
       " 142424: 2.0,\n",
       " 143410: 2.0,\n",
       " 144262: 2.0,\n",
       " 144620: 2.0,\n",
       " 144716: 2.0,\n",
       " 146688: 2.0,\n",
       " 146730: 2.0,\n",
       " 148709: 2.0,\n",
       " 149612: 2.0,\n",
       " 151315: 2.0,\n",
       " 151317: 2.0,\n",
       " 151559: 2.0,\n",
       " 154065: 2.0,\n",
       " 155358: 2.0,\n",
       " 155743: 2.0,\n",
       " 155892: 2.0,\n",
       " 157130: 2.0,\n",
       " 159690: 2.0,\n",
       " 160730: 2.0,\n",
       " 164753: 2.0,\n",
       " 165139: 2.0,\n",
       " 165347: 2.0,\n",
       " 168456: 2.0,\n",
       " 173751: 2.0,\n",
       " 1757: 2.0,\n",
       " 6528: 2.0,\n",
       " 164655: 2.0,\n",
       " 74580: 2.0,\n",
       " 90384: 2.0,\n",
       " 3619: 2.0,\n",
       " 3281: 2.0,\n",
       " 4589: 2.0,\n",
       " 4860: 2.0,\n",
       " 5581: 2.0,\n",
       " 5629: 2.0,\n",
       " 5755: 2.0,\n",
       " 5836: 2.0,\n",
       " 6407: 2.0,\n",
       " 6788: 2.0,\n",
       " 7883: 2.0,\n",
       " 8482: 2.0,\n",
       " 8521: 2.0,\n",
       " 31083: 2.0,\n",
       " 5197: 2.0,\n",
       " 5448: 2.0,\n",
       " 37844: 2.0,\n",
       " 115065: 2.0,\n",
       " 40597: 2.0,\n",
       " 92730: 2.0,\n",
       " 1910: 2.0,\n",
       " 46231: 2.0,\n",
       " 50796: 2.0,\n",
       " 95193: 2.0,\n",
       " 129229: 2.0,\n",
       " 6145: 2.0,\n",
       " 2878: 2.0,\n",
       " 5704: 2.0,\n",
       " 5797: 2.0,\n",
       " 6746: 2.0,\n",
       " 31150: 2.0,\n",
       " 62586: 2.0,\n",
       " 136958: 2.0,\n",
       " 159510: 2.0,\n",
       " 180263: 2.0,\n",
       " 182727: 2.0,\n",
       " 185033: 2.0,\n",
       " 83270: 2.0,\n",
       " 96520: 2.0,\n",
       " 152037: 2.0,\n",
       " 96150: 2.0,\n",
       " 134775: 2.0,\n",
       " 3958: 2.0,\n",
       " 790: 2.0,\n",
       " 1985: 2.0,\n",
       " 3577: 2.0,\n",
       " 3660: 2.0,\n",
       " 3663: 2.0,\n",
       " 3664: 2.0,\n",
       " 44225: 2.0,\n",
       " 47516: 2.0,\n",
       " 70932: 2.0,\n",
       " 5028: 2.0,\n",
       " 81681: 2.0,\n",
       " 102088: 2.0,\n",
       " 150254: 2.0,\n",
       " 1331: 2.0,\n",
       " 1980: 2.0,\n",
       " 2655: 2.0,\n",
       " 2982: 2.0,\n",
       " 3021: 2.0,\n",
       " ...}"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings_dict = {}\n",
    "for i in ratings.index:\n",
    "    if ratings.movieId[i] in ratings_dict:\n",
    "        ratings_dict[ratings.movieId[i]] = ratings_dict[ratings.movieId[i]] + ratings.rating[i]\n",
    "    else:\n",
    "        ratings_dict[ratings.movieId[i]] = ratings.rating[i]\n",
    "\n",
    "#for k, v in ratings_dict.items():\n",
    "    #print(k ,v)\n",
    "\n",
    "#filter = ratings['movieId'] == 1\n",
    "#x = ratings.where(filter, inplace=False)\n",
    "#x = x.dropna()\n",
    "#len(x)\n",
    "\n",
    "for k, v in ratings_dict.items():\n",
    "    filter = ratings['movieId'] == k\n",
    "    x = ratings.where(filter, inplace=False)\n",
    "    x = x.dropna()\n",
    "    #print(k ,v/len(x))\n",
    "    ratings_dict[k] = v/len(x)\n",
    "    \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "24791a10",
   "metadata": {},
   "outputs": [],
   "source": [
    "sorted_dict = dict(sorted(ratings_dict.items(), key=lambda item: item[1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "87efdba8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(3792, 5.0),\n",
       " (26169, 5.0),\n",
       " (26401, 5.0),\n",
       " (72142, 5.0),\n",
       " (76091, 5.0),\n",
       " (96832, 5.0),\n",
       " (100906, 5.0),\n",
       " (107771, 5.0),\n",
       " (115727, 5.0),\n",
       " (138632, 5.0)]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list(sorted_dict.items())[-10:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "029c7e8f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "946cc65c",
   "metadata": {},
   "outputs": [],
   "source": [
    "user_num = ratings.userId.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "28c15aec",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1 232\n",
      "2 29\n",
      "3 39\n",
      "4 216\n",
      "5 44\n",
      "6 314\n",
      "7 152\n",
      "8 47\n",
      "9 46\n",
      "10 140\n",
      "11 64\n",
      "12 32\n",
      "13 31\n",
      "14 48\n",
      "15 135\n",
      "16 98\n",
      "17 105\n",
      "18 502\n",
      "19 703\n",
      "20 242\n",
      "21 443\n",
      "22 119\n",
      "23 121\n",
      "24 110\n",
      "25 26\n",
      "26 21\n",
      "27 135\n",
      "28 570\n",
      "29 81\n",
      "30 34\n",
      "31 50\n",
      "32 102\n",
      "33 156\n",
      "34 86\n",
      "35 23\n",
      "36 60\n",
      "37 21\n",
      "38 78\n",
      "39 100\n",
      "40 103\n",
      "41 217\n",
      "42 440\n",
      "43 114\n",
      "44 48\n",
      "45 399\n",
      "46 42\n",
      "47 140\n",
      "48 33\n",
      "49 21\n",
      "50 310\n",
      "51 359\n",
      "52 130\n",
      "53 20\n",
      "54 33\n",
      "55 25\n",
      "56 46\n",
      "57 476\n",
      "58 112\n",
      "59 107\n",
      "60 22\n",
      "61 39\n",
      "62 366\n",
      "63 271\n",
      "64 517\n",
      "65 34\n",
      "66 345\n",
      "67 36\n",
      "68 1260\n",
      "69 46\n",
      "70 62\n",
      "71 35\n",
      "72 45\n",
      "73 210\n",
      "74 177\n",
      "75 69\n",
      "76 119\n",
      "77 29\n",
      "78 61\n",
      "79 64\n",
      "80 167\n",
      "81 26\n",
      "82 227\n",
      "83 118\n",
      "84 293\n",
      "85 34\n",
      "86 70\n",
      "87 21\n",
      "88 56\n",
      "89 518\n",
      "90 54\n",
      "91 575\n",
      "92 24\n",
      "93 97\n",
      "94 56\n",
      "95 168\n",
      "96 78\n",
      "97 36\n",
      "98 92\n",
      "99 53\n",
      "100 148\n",
      "101 61\n",
      "102 56\n",
      "103 377\n",
      "104 273\n",
      "105 722\n",
      "106 33\n",
      "107 34\n",
      "108 76\n",
      "109 127\n",
      "110 51\n",
      "111 646\n",
      "112 65\n",
      "113 150\n",
      "114 31\n",
      "115 112\n",
      "116 87\n",
      "117 165\n",
      "118 22\n",
      "119 215\n",
      "120 22\n",
      "121 58\n",
      "122 292\n",
      "123 56\n",
      "124 50\n",
      "125 360\n",
      "126 38\n",
      "127 22\n",
      "128 33\n",
      "129 140\n",
      "130 28\n",
      "131 69\n",
      "132 347\n",
      "133 35\n",
      "134 35\n",
      "135 279\n",
      "136 111\n",
      "137 141\n",
      "138 22\n",
      "139 194\n",
      "140 608\n",
      "141 168\n",
      "142 38\n",
      "143 71\n",
      "144 128\n",
      "145 23\n",
      "146 32\n",
      "147 20\n",
      "148 48\n",
      "149 58\n",
      "150 26\n",
      "151 59\n",
      "152 63\n",
      "153 179\n",
      "154 34\n",
      "155 46\n",
      "156 398\n",
      "157 21\n",
      "158 26\n",
      "159 97\n",
      "160 437\n",
      "161 39\n",
      "162 38\n",
      "163 23\n",
      "164 36\n",
      "165 65\n",
      "166 190\n",
      "167 173\n",
      "168 94\n",
      "169 269\n",
      "170 50\n",
      "171 82\n",
      "172 26\n",
      "173 25\n",
      "174 67\n",
      "175 24\n",
      "176 36\n",
      "177 904\n",
      "178 77\n",
      "179 69\n",
      "180 24\n",
      "181 118\n",
      "182 977\n",
      "183 57\n",
      "184 134\n",
      "185 47\n",
      "186 226\n",
      "187 258\n",
      "188 48\n",
      "189 20\n",
      "190 66\n",
      "191 85\n",
      "192 22\n",
      "193 35\n",
      "194 20\n",
      "195 187\n",
      "196 32\n",
      "197 35\n",
      "198 230\n",
      "199 363\n",
      "200 334\n",
      "201 110\n",
      "202 403\n",
      "203 45\n",
      "204 83\n",
      "205 27\n",
      "206 25\n",
      "207 20\n",
      "208 26\n",
      "209 35\n",
      "210 138\n",
      "211 89\n",
      "212 248\n",
      "213 84\n",
      "214 22\n",
      "215 98\n",
      "216 164\n",
      "217 613\n",
      "218 26\n",
      "219 528\n",
      "220 207\n",
      "221 331\n",
      "222 250\n",
      "223 75\n",
      "224 54\n",
      "225 75\n",
      "226 507\n",
      "227 94\n",
      "228 25\n",
      "229 65\n",
      "230 139\n",
      "231 24\n",
      "232 862\n",
      "233 150\n",
      "234 202\n",
      "235 65\n",
      "236 30\n",
      "237 50\n",
      "238 44\n",
      "239 279\n",
      "240 128\n",
      "241 76\n",
      "242 35\n",
      "243 36\n",
      "244 93\n",
      "245 21\n",
      "246 204\n",
      "247 150\n",
      "248 51\n",
      "249 1046\n",
      "250 27\n",
      "251 23\n",
      "252 38\n",
      "253 47\n",
      "254 127\n",
      "255 44\n",
      "256 174\n",
      "257 20\n",
      "258 25\n",
      "259 29\n",
      "260 152\n",
      "261 53\n",
      "262 57\n",
      "263 210\n",
      "264 56\n",
      "265 163\n",
      "266 180\n",
      "267 57\n",
      "268 129\n",
      "269 29\n",
      "270 40\n",
      "271 43\n",
      "272 31\n",
      "273 55\n",
      "274 1346\n",
      "275 403\n",
      "276 41\n",
      "277 28\n",
      "278 20\n",
      "279 176\n",
      "280 196\n",
      "281 21\n",
      "282 237\n",
      "283 35\n",
      "284 88\n",
      "285 36\n",
      "286 106\n",
      "287 152\n",
      "288 1055\n",
      "289 24\n",
      "290 267\n",
      "291 31\n",
      "292 446\n",
      "293 21\n",
      "294 437\n",
      "295 41\n",
      "296 27\n",
      "297 72\n",
      "298 939\n",
      "299 23\n",
      "300 32\n",
      "301 114\n",
      "302 32\n",
      "303 53\n",
      "304 216\n",
      "305 677\n",
      "306 112\n",
      "307 975\n",
      "308 115\n",
      "309 103\n",
      "310 64\n",
      "311 28\n",
      "312 223\n",
      "313 340\n",
      "314 128\n",
      "315 33\n",
      "316 53\n",
      "317 189\n",
      "318 879\n",
      "319 35\n",
      "320 20\n",
      "321 56\n",
      "322 107\n",
      "323 98\n",
      "324 21\n",
      "325 270\n",
      "326 152\n",
      "327 48\n",
      "328 255\n",
      "329 23\n",
      "330 247\n",
      "331 168\n",
      "332 267\n",
      "333 25\n",
      "334 154\n",
      "335 28\n",
      "336 56\n",
      "337 77\n",
      "338 39\n",
      "339 371\n",
      "340 28\n",
      "341 52\n",
      "342 66\n",
      "343 59\n",
      "344 69\n",
      "345 62\n",
      "346 164\n",
      "347 45\n",
      "348 55\n",
      "349 37\n",
      "350 40\n",
      "351 141\n",
      "352 294\n",
      "353 90\n",
      "354 226\n",
      "355 26\n",
      "356 289\n",
      "357 383\n",
      "358 41\n",
      "359 74\n",
      "360 25\n",
      "361 97\n",
      "362 109\n",
      "363 30\n",
      "364 21\n",
      "365 277\n",
      "366 31\n",
      "367 185\n",
      "368 469\n",
      "369 129\n",
      "370 93\n",
      "371 41\n",
      "372 236\n",
      "373 100\n",
      "374 33\n",
      "375 33\n",
      "376 133\n",
      "377 131\n",
      "378 48\n",
      "379 36\n",
      "380 1218\n",
      "381 474\n",
      "382 291\n",
      "383 34\n",
      "384 70\n",
      "385 201\n",
      "386 68\n",
      "387 1027\n",
      "388 29\n",
      "389 34\n",
      "390 81\n",
      "391 386\n",
      "392 25\n",
      "393 123\n",
      "394 23\n",
      "395 61\n",
      "396 28\n",
      "397 23\n",
      "398 46\n",
      "399 36\n",
      "400 43\n",
      "401 72\n",
      "402 48\n",
      "403 34\n",
      "404 60\n",
      "405 120\n",
      "406 20\n",
      "407 22\n",
      "408 141\n",
      "409 126\n",
      "410 167\n",
      "411 127\n",
      "412 102\n",
      "413 56\n",
      "414 2698\n",
      "415 94\n",
      "416 51\n",
      "417 67\n",
      "418 93\n",
      "419 155\n",
      "420 141\n",
      "421 37\n",
      "422 93\n",
      "423 23\n",
      "424 138\n",
      "425 306\n",
      "426 88\n",
      "427 84\n",
      "428 300\n",
      "429 58\n",
      "430 58\n",
      "431 20\n",
      "432 260\n",
      "433 22\n",
      "434 233\n",
      "435 42\n",
      "436 106\n",
      "437 122\n",
      "438 635\n",
      "439 21\n",
      "440 33\n",
      "441 45\n",
      "442 20\n",
      "443 37\n",
      "444 42\n",
      "445 77\n",
      "446 84\n",
      "447 78\n",
      "448 1864\n",
      "449 38\n",
      "450 51\n",
      "451 34\n",
      "452 202\n",
      "453 311\n",
      "454 45\n",
      "455 57\n",
      "456 43\n",
      "457 50\n",
      "458 59\n",
      "459 26\n",
      "460 82\n",
      "461 27\n",
      "462 455\n",
      "463 33\n",
      "464 138\n",
      "465 115\n",
      "466 113\n",
      "467 22\n",
      "468 33\n",
      "469 465\n",
      "470 80\n",
      "471 28\n",
      "472 29\n",
      "473 37\n",
      "474 2108\n",
      "475 155\n",
      "476 69\n",
      "477 600\n",
      "478 22\n",
      "479 181\n",
      "480 836\n",
      "481 31\n",
      "482 128\n",
      "483 728\n",
      "484 275\n",
      "485 23\n",
      "486 56\n",
      "487 56\n",
      "488 111\n",
      "489 648\n",
      "490 113\n",
      "491 64\n",
      "492 121\n",
      "493 61\n",
      "494 22\n",
      "495 265\n",
      "496 29\n",
      "497 51\n",
      "498 35\n",
      "499 27\n",
      "500 86\n",
      "501 45\n",
      "502 35\n",
      "503 95\n",
      "504 87\n",
      "505 31\n",
      "506 42\n",
      "507 21\n",
      "508 24\n",
      "509 467\n",
      "510 108\n",
      "511 52\n",
      "512 50\n",
      "513 32\n",
      "514 397\n",
      "515 26\n",
      "516 26\n",
      "517 400\n",
      "518 24\n",
      "519 26\n",
      "520 186\n",
      "521 40\n",
      "522 200\n",
      "523 75\n",
      "524 131\n",
      "525 500\n",
      "526 58\n",
      "527 167\n",
      "528 73\n",
      "529 25\n",
      "530 27\n",
      "531 22\n",
      "532 50\n",
      "533 38\n",
      "534 520\n",
      "535 30\n",
      "536 40\n",
      "537 47\n",
      "538 37\n",
      "539 38\n",
      "540 42\n",
      "541 87\n",
      "542 113\n",
      "543 76\n",
      "544 22\n",
      "545 23\n",
      "546 64\n",
      "547 21\n",
      "548 26\n",
      "549 21\n",
      "550 28\n",
      "551 123\n",
      "552 188\n",
      "553 83\n",
      "554 89\n",
      "555 578\n",
      "556 32\n",
      "557 27\n",
      "558 56\n",
      "559 140\n",
      "560 458\n",
      "561 505\n",
      "562 231\n",
      "563 213\n",
      "564 157\n",
      "565 29\n",
      "566 74\n",
      "567 385\n",
      "568 23\n",
      "569 20\n",
      "570 191\n",
      "571 112\n",
      "572 155\n",
      "573 299\n",
      "574 23\n",
      "575 36\n",
      "576 20\n",
      "577 161\n",
      "578 27\n",
      "579 73\n",
      "580 436\n",
      "581 40\n",
      "582 56\n",
      "583 56\n",
      "584 83\n",
      "585 61\n",
      "586 208\n",
      "587 165\n",
      "588 56\n",
      "589 40\n",
      "590 728\n",
      "591 54\n",
      "592 94\n",
      "593 103\n",
      "594 232\n",
      "595 20\n",
      "596 411\n",
      "597 443\n",
      "598 21\n",
      "599 2478\n",
      "600 763\n",
      "601 101\n",
      "602 135\n",
      "603 943\n",
      "604 100\n",
      "605 221\n",
      "606 1115\n",
      "607 187\n",
      "608 831\n",
      "609 37\n",
      "610 1302\n"
     ]
    }
   ],
   "source": [
    "users_dict = {}\n",
    "for user in user_num:\n",
    "    filter = ratings['userId'] == user\n",
    "    x = ratings.where(filter, inplace=False).dropna()\n",
    "    print(user, len(x)) \n",
    "    users_dict[user] = len(x)\n",
    "    \n",
    "sort_dict = dict(sorted(users_dict.items(), key=lambda item: item[1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "5dd785d5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(274, 1346), (448, 1864), (474, 2108), (599, 2478), (414, 2698)]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list(sort_dict.items())[-5:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "3abff8bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4.0</td>\n",
       "      <td>964982703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4.0</td>\n",
       "      <td>964981247</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>4.0</td>\n",
       "      <td>964982224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>5.0</td>\n",
       "      <td>964983815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>5.0</td>\n",
       "      <td>964982931</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100831</th>\n",
       "      <td>610</td>\n",
       "      <td>166534</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1493848402</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100832</th>\n",
       "      <td>610</td>\n",
       "      <td>168248</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1493850091</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100833</th>\n",
       "      <td>610</td>\n",
       "      <td>168250</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1494273047</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100834</th>\n",
       "      <td>610</td>\n",
       "      <td>168252</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1493846352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100835</th>\n",
       "      <td>610</td>\n",
       "      <td>170875</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1493846415</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100836 rows Ã— 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        userId  movieId  rating   timestamp\n",
       "0            1        1     4.0   964982703\n",
       "1            1        3     4.0   964981247\n",
       "2            1        6     4.0   964982224\n",
       "3            1       47     5.0   964983815\n",
       "4            1       50     5.0   964982931\n",
       "...        ...      ...     ...         ...\n",
       "100831     610   166534     4.0  1493848402\n",
       "100832     610   168248     5.0  1493850091\n",
       "100833     610   168250     5.0  1494273047\n",
       "100834     610   168252     5.0  1493846352\n",
       "100835     610   170875     3.0  1493846415\n",
       "\n",
       "[100836 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(ratings)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "2862351b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>66662</th>\n",
       "      <td>429.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66665</th>\n",
       "      <td>429.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66667</th>\n",
       "      <td>429.0</td>\n",
       "      <td>161.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66669</th>\n",
       "      <td>429.0</td>\n",
       "      <td>165.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66678</th>\n",
       "      <td>429.0</td>\n",
       "      <td>218.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66679</th>\n",
       "      <td>429.0</td>\n",
       "      <td>222.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66680</th>\n",
       "      <td>429.0</td>\n",
       "      <td>225.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66681</th>\n",
       "      <td>429.0</td>\n",
       "      <td>227.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66705</th>\n",
       "      <td>429.0</td>\n",
       "      <td>343.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66706</th>\n",
       "      <td>429.0</td>\n",
       "      <td>349.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66707</th>\n",
       "      <td>429.0</td>\n",
       "      <td>351.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66710</th>\n",
       "      <td>429.0</td>\n",
       "      <td>420.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66711</th>\n",
       "      <td>429.0</td>\n",
       "      <td>421.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66712</th>\n",
       "      <td>429.0</td>\n",
       "      <td>432.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66713</th>\n",
       "      <td>429.0</td>\n",
       "      <td>434.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66714</th>\n",
       "      <td>429.0</td>\n",
       "      <td>468.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66716</th>\n",
       "      <td>429.0</td>\n",
       "      <td>588.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66717</th>\n",
       "      <td>429.0</td>\n",
       "      <td>590.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66718</th>\n",
       "      <td>429.0</td>\n",
       "      <td>592.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66719</th>\n",
       "      <td>429.0</td>\n",
       "      <td>595.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>828124615.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       userId  movieId  rating    timestamp\n",
       "66662   429.0     22.0     4.0  828124615.0\n",
       "66665   429.0    150.0     5.0  828124615.0\n",
       "66667   429.0    161.0     5.0  828124615.0\n",
       "66669   429.0    165.0     4.0  828124615.0\n",
       "66678   429.0    218.0     4.0  828124615.0\n",
       "66679   429.0    222.0     4.0  828124615.0\n",
       "66680   429.0    225.0     4.0  828124615.0\n",
       "66681   429.0    227.0     3.0  828124615.0\n",
       "66705   429.0    343.0     3.0  828124615.0\n",
       "66706   429.0    349.0     3.0  828124615.0\n",
       "66707   429.0    351.0     4.0  828124615.0\n",
       "66710   429.0    420.0     2.0  828124615.0\n",
       "66711   429.0    421.0     4.0  828124615.0\n",
       "66712   429.0    432.0     3.0  828124615.0\n",
       "66713   429.0    434.0     4.0  828124615.0\n",
       "66714   429.0    468.0     3.0  828124615.0\n",
       "66716   429.0    588.0     5.0  828124615.0\n",
       "66717   429.0    590.0     5.0  828124615.0\n",
       "66718   429.0    592.0     5.0  828124615.0\n",
       "66719   429.0    595.0     5.0  828124615.0"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.timestamp.min()\n",
    "filter = ratings['timestamp'] == ratings.timestamp.min()\n",
    "x = ratings.where(filter, inplace=False).dropna()\n",
    "x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "464cbec9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1537799250"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.timestamp.max()"
   ]
  },
  {
   "cell_type": "raw",
   "id": "ee8817cf",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
